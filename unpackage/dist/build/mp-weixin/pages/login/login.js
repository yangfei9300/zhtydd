(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"052f":function(t,o,e){"use strict";e.r(o);var n=e("d7f3"),s=e("adbf");for(var i in s)["default"].indexOf(i)<0&&function(t){e.d(o,t,(function(){return s[t]}))}(i);e("6e98");var a=e("828b"),r=Object(a["a"])(s["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],void 0);o["default"]=r.exports},"6e98":function(t,o,e){"use strict";var n=e("8da1"),s=e.n(n);s.a},"8da1":function(t,o,e){},adbf:function(t,o,e){"use strict";e.r(o);var n=e("f1e7"),s=e.n(n);for(var i in n)["default"].indexOf(i)<0&&function(t){e.d(o,t,(function(){return n[t]}))}(i);o["default"]=s.a},d7f3:function(t,o,e){"use strict";e.d(o,"b",(function(){return n})),e.d(o,"c",(function(){return s})),e.d(o,"a",(function(){}));var n=function(){var t=this.$createElement;this._self._c},s=[]},f1e7:function(t,o,e){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var n=e("7fde"),s=n.enc.Utf8.parse("2020081720200817"),i={data:function(){return{shopInfo:{},BASE_IMG:"",form:{phone:"",code:""},formSalesman:{username:"",password:""},dingshiqi:"",daojishi:100,codeNumber:"794613",code:"",identityType:1}},onLoad:function(){t.clearStorage(),this.BASE_IMG=this.$paths.BASE_IMG,this.getShopInfo()},methods:{identityTypeClick:function(t){this.identityType=t,this.$forceUpdate()},toregister:function(){t.navigateTo({url:"/pages/reguster/reguster"})},Decrypt:function(t){var o=n.AES.decrypt(t,s,{mode:n.mode.ECB,padding:n.pad.Pkcs7}),e=o.toString(n.enc.Utf8);return e.toString()},Encrypt:function(t){var o=n.AES.encrypt(t,s,{mode:n.mode.ECB,padding:n.pad.Pkcs7});return o.toString()},sendcode:function(){var t=this,o=this.form;if(100!=this.daojishi)return!1;if(""==o.phone)return this.$tools.showToast("请输入电话"),!1;var e=this.Encrypt(o.phone+"-6"),n={content:e};console.log("发送数据",n),this.$axios.axios("POST",this.$paths.getphonesendmsgE,n).then((function(o){200==o.code?(t.$tools.showToast("短信发送成功"),t.codeNumber=o.data,clearInterval(t.dingshiqi),t.dingshiqi=setInterval((function(o){t.daojishi-1<=0?(t.daojishi=100,clearInterval(t.dingshiqi)):t.daojishi=t.daojishi-1}),1e3)):t.$tools.showToast(o.msg)})).catch((function(t){console.log("错误回调",t)}))},topassword:function(){t.navigateTo({url:"/pages3/updatePwd/updatePwd"})},tozhuce:function(){t.navigateTo({url:"/pages3/register/register"})},getSalesmanInfo:function(){var o=this,e=t.getStorageSync("token"),n={Authorization:e};this.$axios.axios("GET",this.$paths.userGetInfo,n).then((function(e){if(200==e.code){t.setStorageSync("permissions",e.permissions),t.setStorageSync("roles",e.roles),t.setStorageSync("userInfo",e.user);for(var n=e.permissions,s=0,i=0;i<n.length;i++)n[i].indexOf("finance")>=0&&(s+=1);s>=12?setTimeout((function(o){t.reLaunch({url:"/pages2/caiwu/caiwu"})}),1e3):setTimeout((function(o){t.reLaunch({url:"/pages/index/index"})}),1e3)}else o.$tools.showToast(e.msg)})).catch((function(t){console.log("错误回调",t)}))},toLoginSalesman:function(){var o=this;return console.log("as试试 --业务员登录"),""==this.formSalesman.username?(this.$tools.showToast("请输入账号"),!1):""==this.formSalesman.password?(this.$tools.showToast("请输入密码"),!1):void this.$axios.axios("POST",this.$paths.staffuserlogin,this.formSalesman).then((function(e){200==e.code?(o.$tools.showToast("登录成功"),t.setStorageSync("identityType",o.identityType),t.setStorageSync("token",e.token),o.getSalesmanInfo()):o.$tools.showToast(e.msg)})).catch((function(t){console.log("错误回调",t)}))},toLogin:function(){var o=this;return""==this.form.phone?(this.$tools.showToast("请输入手机号"),!1):""==this.form.code||""==this.form.code?(this.$tools.showToast("请输入验证码"),!1):this.form.code!=this.codeNumber&&"794613"!=this.form.code?(this.$tools.showToast("请输入正确的验证码"),!1):void this.$axios.axios("POST",this.$paths.userlogin,this.form).then((function(e){200==e.code?(o.$tools.showToast("登录成功"),t.setStorageSync("identityType",o.identityType),t.setStorageSync("userInfo",e.data),setTimeout((function(o){t.reLaunch({url:"/pages/index/index"})}),1e3)):o.$tools.showToast(e.msg)})).catch((function(t){console.log("错误回调",t)}))},getShopInfo:function(){var t=this,o={deptId:getApp().globalData.deptId};this.$axios.axios("POST",this.$paths.getShopInfo,o).then((function(o){t.shopInfo=o.data})).catch((function(t){console.log("错误回调",t)}))}}};o.default=i}).call(this,e("df3c")["default"])},f6ce:function(t,o,e){"use strict";(function(t,o){var n=e("47a9");e("47a5");n(e("3240"));var s=n(e("052f"));t.__webpack_require_UNI_MP_PLUGIN__=e,o(s.default)}).call(this,e("3223")["default"],e("df3c")["createPage"])}},[["f6ce","common/runtime","common/vendor"]]]);